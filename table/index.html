<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Соревнования - Over Time Zvenigorod</title>
    <meta name="description" content="Турнирная таблица и расписание матчей баскетбольной лиги Over Time Zvenigorod">
    <meta property="og:title" content="Соревнования - Over Time Zvenigorod">
    <meta property="og:description" content="Турнирная таблица и расписание матчей баскетбольной лиги Over Time Zvenigorod">
    <meta property="og:image" content="https://otz2025.github.io/otz2025/img/OTZ3.png">
    <meta property="og:url" content="https://otz2025.github.io/otz2025/table">
    <link rel="icon" type="image/png" href="/otz2025/img/OTZ3.png">

    <style>
        /* Общие стили */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #2a2a2a;
            color: white;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Фиксированное меню */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 1);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px 20px;
            z-index: 1000;
            transition: background-color 0.3s ease;
        }

        header.scrolled {
            background-color: rgba(0, 0, 0, 0.7);
        }

        header .logo {
            position: absolute;
            left: 20px;
            font-size: 24px;
            font-weight: bold;
            color: white;
        }

        header nav {
            display: flex;
            gap: 20px;
        }

        header nav a {
            color: white;
            text-decoration: none;
            font-size: 18px;
            transition: color 0.3s ease;
        }

        header nav a:hover {
            color: #ccc;
        }

        /* Основной контент */
        .content {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            flex: 1;
            box-sizing: border-box;
            text-align: center;
            margin-top: 100px;
            width: 100%;
        }

        .content h2 {
            font-size: 36px;
            margin-bottom: 20px;
            padding-top: 20px;
            border-top: 1px solid black;
            position: relative;
            display: inline-block;
            padding: 15px 30px;
        }

        .content h2::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #dd4710;
            z-index: -1;
            border-radius: 5px;
        }

        /* Таблица */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
            margin-bottom: 40px;
            width: 100%;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-width: 600px;
        }

        th, td {
            padding: 16px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }

        th:last-child, td:last-child {
            border-right: none;
        }

        th {
            background-color: #dd4710;
            font-weight: bold;
        }

        tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        /* Логотипы команд */
        .team-logo {
            width: 30px;
            height: 30px;
            vertical-align: middle;
            margin-right: 10px;
        }

        /* Выравнивание логотипа и текста по горизонтали */
        .team-cell {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Блок с матчами */
        .match-results {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 40px;
        }

        .match-result {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .match-results .team-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 120px;
        }

        .match-results .team-name {
            margin-top: 8px;
            font-size: 16px;
            text-align: center;
        }

        .team-logo img {
            width: 50px;
            height: 50px;
        }

        .score {
            font-size: 24px;
            font-weight: bold;
            margin: 0 20px;
            min-width: 80px;
            text-align: center;
        }

        .date {
            font-size: 18px;
            color: #ccc;
            margin-top: 10px;
            text-align: center;
        }

        /* Футер */
        footer {
            background-color: #000;
            padding: 40px 20px;
            margin-top: auto;
            width: 100%;
            box-sizing: border-box;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            text-align: center;
        }

        .social-links {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .social-links a {
            color: white;
            text-decoration: none;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .social-links a:hover {
            transform: scale(1.1);
            opacity: 0.8;
        }

        .social-links img {
            width: 24px;
            height: 24px;
        }

        /* Стиль для скрытия слова "Абоюдно" */
        .hidden {
            display: none;
        }

        /* Адаптация для мобильных устройств */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                padding: 10px;
            }

            header .logo {
                position: static;
                margin-bottom: 10px;
                text-align: center;
            }

            header nav {
                display: flex;
                flex-direction: row;
                justify-content: center;
                gap: 10px;
                flex-wrap: wrap;
            }

            .content {
                margin-top: 80px;
            }

            .content h2 {
                font-size: 28px;
                padding: 10px 20px;
            }

            th, td {
                padding: 12px;
                font-size: 14px;
            }

            .team-logo {
                width: 24px;
                height: 24px;
            }

            .table-container {
                overflow-x: auto;
                width: 100%;
            }

            table {
                min-width: 600px;
            }

            .match-results {
                margin-top: 20px;
            }

            .match-result {
                padding: 15px;
            }

            .team-logo img {
                width: 50px;
                height: 50px;
            }

            .score {
                font-size: 20px;
            }

            .date {
                font-size: 16px;
            }
        }

        /* Новые стили */
        .table-header {
            text-align: left;
            margin-bottom: 20px;
        }

        .table-header h3 {
            font-size: 24px;
            margin-bottom: 10px;
            display: inline-block;
        }

        .table-header hr {
            border: 0;
            height: 1px;
            background-color: rgba(255, 255, 255, 0.2);
            margin: 0;
        }

        .schedule-link {
            margin-top: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .schedule-link a {
            color: #dd4710;
            text-decoration: none;
            font-size: 18px;
            transition: color 0.3s ease;
        }

        .schedule-link a:hover {
            color: #ff6b3b;
        }

        /* Стили для ссылок команд */
        .team-cell a, .team-name a {
            color: white;
            text-decoration: none;
        }

        .team-cell a:hover, .team-name a:hover {
            color: white;
            text-decoration: none;
        }

        @media (max-width: 768px) {
            .team-cell a, .team-name a {
                font-size: 14px;
            }
        }
    </style>
 
</head>
<body>
    <header id="header">
        <div class="logo">OVER TIME ZWENIGOROD</div>
        <nav>
            <a href="/otz2025/">Главная</a>
            <a href="/otz2025/news">Новости</a>
            <a href="/otz2025/table">Соревнования</a>
            <a href="/otz2025/reward">Награды</a>
        </nav>
    </header>

    <div class="content">
        <h2>Соревнования</h2>

        <!-- Блок результатов -->
        <div class="match-results" id="featuredMatchesContainer">
            <div class="table-header">
                <h3>Ближайшие матчи</h3>
                <hr>
            </div>
            <div class="loading">Загрузка матчей...</div>
        </div>

        <!-- Ссылка на расписание -->
        <div class="schedule-link">
            <a href="/otz2025/schedule">Посмотреть полное расписание</a>
        </div>

        <!-- Турнирная таблица -->
        <div class="table-header">
            <h3>Турнирная таблица</h3>
            <hr>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Место</th>
                        <th>Команда</th>
                        <th>И</th>
                        <th>В</th>
                        <th>П</th>
                        <th>%</th>
                        <th>Забито</th>
                        <th>Пропущено</th>
                        <th>+/-</th>
                        <th>Очки</th>
                    </tr>
                </thead>
                <tbody id="tournamentTableBody"></tbody>
            </table>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="social-links">
                <a href="https://www.tiktok.com/@otz.summer.league" target="_blank">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white">
                        <path d="M19.589 6.686a4.793 4.793 0 0 1-3.77-4.245V2h-3.445v13.672a2.896 2.896 0 0 1-5.201 1.743l-.002-.001.002.001a2.895 2.895 0 0 1 3.183-4.51v-3.5a6.329 6.329 0 0 0-5.394 10.692 6.33 6.33 0 0 0 10.857-4.424V8.687a8.182 8.182 0 0 0 4.773 1.526V6.79a4.831 4.831 0 0 1-1.003-.104z"/>
                    </svg>
                </a>
                <a href="https://t.me/pisunapidora" target="_blank">
                    <img src="/otz2025/img/TG.png" alt="Telegram">
                </a>
            </div>
            <p>© 2025 Over Time Zvenigorod. Все права защищены.</p>
        </div>
    </footer>

    <script>
    // Конфигурация
    const CONFIG = {
        TOURNAMENT_DATA_URL: "https://raw.githubusercontent.com/otz2026/otz2025/main/SSTimeSS/tournament_data.json",
        FEATURED_MATCHES_URL: "https://raw.githubusercontent.com/otz2026/otz2025/main/SSTimeSS/featured_matches.json",
        SCHEDULE_DATA_URL: "https://raw.githubusercontent.com/otz2026/otz2025/main/SSTimeSS/schedule_data.json",
        UPDATE_INTERVAL: 30000
    };

    // Основные функции для турнирной таблицы
    async function loadTournamentData() {
        try {
            const response = await fetch(`${CONFIG.TOURNAMENT_DATA_URL}?t=${Date.now()}`);
            if (!response.ok) throw new Error('Ошибка загрузки данных');
            return await response.json();
        } catch (error) {
            console.error('Ошибка:', error);
            return getDefaultTeamsData();
        }
    }

    function getDefaultTeamsData() {
        return [
            { id: "Bulldogs", team: "BULLDOGS", logo: "/otz2025/img/BULLDOGS.png", games: 0, wins: 0, losses: 0, scored: 0, conceded: 0, urlname: "Bulldogs" },
            { id: "TN", team: "TEXAS NERS", logo: "/otz2025/img/TN.png", games: 0, wins: 0, losses: 0, scored: 0, conceded: 0, urlname: "TN" },
            { id: "RWE", team: "RWE", logo: "/otz2025/img/RWE.png", games: 0, wins: 0, losses: 0, scored: 0, conceded: 0, urlname: "RWE" },
            { id: "KittyBoys", team: "KITTY BOYS", logo: "/otz2025/img/KITTY BOYS.png", games: 0, wins: 0, losses: 0, scored: 0, conceded: 0, urlname: "KittyBoys" },
            { id: "PawPatrol", team: "PAW PATROL", logo: "/otz2025/img/PPATROL.png", games: 0, wins: 0, losses: 0, scored: 0, conceded: 0, urlname: "PawPatrol" }
        ];
    }

    async function updateTournamentTable() {
        const data = await loadTournamentData();
        const tableBody = document.getElementById('tournamentTableBody');
        if (!tableBody) return;

        const processedData = data.map(team => ({
            ...team,
            percentage: team.games > 0 ? ((team.wins / team.games) * 100).toFixed(1) : 0,
            difference: (team.scored || 0) - (team.conceded || 0),
            points: (team.wins || 0) * 2 + (team.losses || 0) * 1
        }));

        processedData.sort((a, b) => {
            if (b.points !== a.points) return b.points - a.points;
            if (b.difference !== a.difference) return b.difference - a.difference;
            return b.scored - a.scored;
        });

        tableBody.innerHTML = processedData.map((team, index) => `
            <tr>
                <td>${index + 1}</td>
                <td class="team-cell">
                    <img src="${team.logo}" class="team-logo" onerror="this.src='/otz2025/img/default-team.png'">
                    <a href="/otz2025/teams/${team.urlname}">${team.team}</a>
                </td>
                <td>${team.games || 0}</td>
                <td>${team.wins || 0}</td>
                <td>${team.losses || 0}</td>
                <td>${team.percentage}</td>
                <td>${team.scored || 0}</td>
                <td>${team.conceded || 0}</td>
                <td>${team.difference}</td>
                <td>${team.points}</td>
            </tr>
        `).join('');
    }

    // Функции для результатов матчей
    async function loadFeaturedMatches() {
        try {
            const [featuredResponse, scheduleResponse] = await Promise.all([
                fetch(`${CONFIG.FEATURED_MATCHES_URL}?t=${Date.now()}`),
                fetch(`${CONFIG.SCHEDULE_DATA_URL}?t=${Date.now()}`)
            ]);
            
            if (!featuredResponse.ok || !scheduleResponse.ok) throw new Error('Ошибка загрузки данных');
            
            const featuredData = await featuredResponse.json();
            const scheduleData = await scheduleResponse.json();
            
            displayFeaturedMatches(featuredData.featured, scheduleData.schedule);
        } catch (error) {
            console.error('Ошибка загрузки матчей:', error);
            renderFallbackMatches();
        }
    }

    function displayFeaturedMatches(featuredMatches, scheduleData) {
        const matchesContainer = document.getElementById('featuredMatchesContainer');
        if (!matchesContainer || !featuredMatches?.length) {
            renderFallbackMatches();
            return;
        }

        const matchesToShow = [];
        featuredMatches.forEach(matchId => {
            const [stage, index] = matchId.split('|');
            if (scheduleData[stage]?.[index]) {
                matchesToShow.push({
                    ...scheduleData[stage][index],
                    stageName: stage
                });
            }
        });

        if (matchesToShow.length === 0) {
            renderFallbackMatches();
            return;
        }

        matchesToShow.sort((a, b) => parseMatchDate(a.date) - parseMatchDate(b.date));
        renderMatches(matchesToShow.slice(0, 2));
    }

    function parseMatchDate(dateStr) {
        const months = {
            'января': 0, 'февраля': 1, 'марта': 2, 'апреля': 3, 'мая': 4, 'июня': 5,
            'июля': 6, 'августа': 7, 'сентября': 8, 'октября': 9, 'ноября': 10, 'декабря': 11
        };
        
        const parts = dateStr?.split(' ') || [];
        const day = parseInt(parts[0]) || 1;
        const month = months[parts[1]?.toLowerCase()] || 0;
        const [hours, minutes] = (parts[2]?.split(':') || ['0','0']).map(Number);
        
        return new Date(new Date().getFullYear(), month, day, hours, minutes);
    }

    function renderFallbackMatches() {
        const container = document.getElementById('featuredMatchesContainer');
        if (!container) return;
        
        container.innerHTML = `
            <div class="table-header">
                <h3>Ближайшие матчи</h3>
                <hr>
            </div>
            <div class="match-result">
                <div class="teams">
                    <div class="team-logo">
                        <img src="/otz2025/img/PPATROL.png" alt="Paw patrol">
                        <div class="team-name">
                            <a href="/otz2025/teams/PawPatrol">Paw Patrol</a>
                        </div>
                    </div>
                    <div class="score">Не начался</div>
                    <div class="team-logo">
                        <img src="/otz2025/img/RWE.png" alt="RWE">
                        <div class="team-name">
                            <a href="/otz2025/teams/RWE">RWE</a>
                        </div>
                    </div>
                </div>
                <div class="date">Следите за обновлениями</div>
            </div>
        `;
    }

    function renderMatches(matches) {
        const container = document.getElementById('featuredMatchesContainer');
        if (!container) return;
        
        const now = new Date();
        const matchesHTML = matches.map(match => `
            <div class="match-result ${parseMatchDate(match.date) < now ? 'past-match' : ''}">
                <div class="teams">
                    <div class="team-logo">
                        <img src="${match.team1?.logo || '/otz2025/img/default-team.png'}" 
                             alt="${match.team1?.name || 'Team 1'}"
                             onerror="this.src='/otz2025/img/default-team.png'">
                        <div class="team-name">
                            <a href="${match.team1?.link || '/otz2025/teams/default'}">${match.team1?.name || 'Team 1'}</a>
                        </div>
                    </div>
                    <div class="score">${match.score || 'vs'}</div>
                    <div class="team-logo">
                        <img src="${match.team2?.logo || '/otz2025/img/default-team.png'}" 
                             alt="${match.team2?.name || 'Team 2'}"
                             onerror="this.src='/otz2025/img/default-team.png'">
                        <div class="team-name">
                            <a href="${match.team2?.link || '/otz2025/teams/default'}">${match.team2?.name || 'Team 2'}</a>
                        </div>
                    </div>
                </div>
                <div class="date">${match.date || 'Дата уточняется'}</div>
            </div>
        `).join('');

        container.innerHTML = `
            <div class="table-header">
                <h3>Ближайшие матчи</h3>
                <hr>
            </div>
            ${matchesHTML}
        `;
    }

    // Инициализация
    function initAutoRefresh() {
        updateTournamentTable();
        loadFeaturedMatches();
        
        setInterval(() => {
            updateTournamentTable();
            loadFeaturedMatches();
        }, CONFIG.UPDATE_INTERVAL);
    }

    document.addEventListener('DOMContentLoaded', () => {
        initAutoRefresh();
        
        window.addEventListener('scroll', () => {
            const header = document.getElementById('header');
            if (header) header.classList.toggle('scrolled', window.scrollY > 50);
        });
    });
    </script>
</body>
</html>
